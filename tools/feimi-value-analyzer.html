<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é£ç±³ç§¯åˆ†ä»·å€¼è§‚åˆ†æå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px;
        }

        .input-section {
            margin-bottom: 40px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 1.1em;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }

        .form-textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .form-textarea:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        .analyze-btn {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            width: 100%;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
        }

        .analyze-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .result-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e5e7eb;
        }

        .result-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #374151;
            margin-right: 15px;
        }

        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #e5e7eb;
            border-top: 2px solid #4f46e5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            display: none;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result-content {
            background: #f8fafc;
            border-radius: 8px;
            padding: 25px;
            border: 1px solid #e2e8f0;
            min-height: 100px;
            font-size: 1.05em;
            line-height: 1.6;
            color: #374151;
        }

        .result-content h1, .result-content h2, .result-content h3 {
            color: #1f2937;
            margin-top: 20px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .result-content h1 {
            font-size: 1.5em;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 8px;
        }

        .result-content h2 {
            font-size: 1.3em;
            color: #4f46e5;
        }

        .result-content h3 {
            font-size: 1.2em;
            color: #6366f1;
        }

        .result-content strong {
            font-weight: 600;
            color: #1f2937;
        }

        .result-content em {
            font-style: italic;
            color: #6b7280;
        }

        .result-content p {
            margin-bottom: 12px;
        }

        .result-content ul, .result-content ol {
            margin-left: 20px;
            margin-bottom: 12px;
        }

        .result-content li {
            margin-bottom: 6px;
        }

        .result-content code {
            background: #e5e7eb;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .result-content blockquote {
            border-left: 4px solid #4f46e5;
            padding-left: 15px;
            margin: 12px 0;
            font-style: italic;
            color: #6b7280;
        }

        .highlight-rule {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            font-weight: 600;
            display: inline-block;
            margin: 8px 0;
        }

        .case-content {
            background: #fff;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .category-tag {
            display: inline-block;
            background: #f3f4f6;
            color: #4b5563;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.85em;
            margin-left: 8px;
            font-weight: 500;
        }

        .category-tag.å¦ç‡çœŸè¯š { background: #dbeafe; color: #1e40af; }
        .category-tag.å¼€æ”¾åä½œ { background: #d1fae5; color: #059669; }
        .category-tag.æ‰¿è¯ºæ•¢ä¸º { background: #fed7d7; color: #c53030; }
        .category-tag.å°Šé‡è°¦é€Š { background: #f3e8ff; color: #7c3aed; }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9em;
            cursor: pointer;
            transition: all 0.2s ease;
            display: none;
        }

        .copy-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3);
        }

        .copy-btn:active {
            transform: translateY(0);
        }

        .copy-btn.copied {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        }

        .result-section {
            position: relative;
        }

        .result-empty {
            text-align: center;
            color: #6b7280;
            font-style: italic;
        }

        .typing-cursor {
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .error-message {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .value-badge {
            display: inline-block;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            margin-right: 8px;
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>é£ç±³ç§¯åˆ†ä»·å€¼è§‚åˆ†æå™¨</h1>
            <p>åŸºäºäº‹ä»¶æ–‡æœ¬æ™ºèƒ½åŒ¹é…ä»·å€¼è§‚å‡†åˆ™ï¼Œç”Ÿæˆè¡Œä¸ºæ¡ˆä¾‹å’Œæ¨èç†ç”±</p>
        </div>
        
        <div class="main-content">
            <div class="input-section">
                <div class="form-group">
                    <label for="eventText" class="form-label">è¯·è¾“å…¥äº‹ä»¶æ–‡æœ¬ï¼š</label>
                    <textarea 
                        id="eventText" 
                        class="form-textarea" 
                        placeholder="è¯·è¯¦ç»†æè¿°å‘ç”Ÿçš„äº‹ä»¶ï¼ŒåŒ…æ‹¬æ—¶é—´ã€åœ°ç‚¹ã€äººç‰©ã€å…·ä½“è¡Œä¸ºç­‰ä¿¡æ¯ï¼Œç³»ç»Ÿå°†åŸºäºè¿™äº›ä¿¡æ¯åˆ†ææœ€ç¬¦åˆçš„ä»·å€¼è§‚å‡†åˆ™..."
                    ></textarea>
                </div>
                <button id="analyzeBtn" class="analyze-btn">
                    åˆ†æä»·å€¼è§‚åŒ¹é…
                </button>
            </div>
            
            <div class="result-section">
                <div class="result-header">
                    <h3 class="result-title">åˆ†æç»“æœ</h3>
                    <div id="loadingSpinner" class="loading-spinner"></div>
                </div>
                <button id="copyBtn" class="copy-btn">ğŸ“‹ å¤åˆ¶ç»“æœ</button>
                <div id="resultContent" class="result-content">
                    <div class="result-empty">
                        è¯·è¾“å…¥äº‹ä»¶æ–‡æœ¬å¹¶ç‚¹å‡»åˆ†ææŒ‰é’®ï¼Œç³»ç»Ÿå°†ä¸ºæ‚¨åŒ¹é…æœ€é€‚åˆçš„ä»·å€¼è§‚å‡†åˆ™
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'https://api.deepseek.com/v1/chat/completions';
        const API_KEY = 'sk-08fd0b2b32284162bad21e12b9f07c14';

        const valueRules = {
            'C1': { name: 'ç»å¯¹å¦ç‡', purpose: 'å»ºç«‹å¦è¯šé«˜æ•ˆçš„æ²Ÿé€šæ–‡åŒ–', behaviors: ['ä¸»åŠ¨å‘èµ·äº‰è®®å¯¹è¯', 'é«˜æ•ˆåŒ–è§£åˆ†æ­§'] },
            'C2': { name: 'ä¿¡æ¯é€æ˜', purpose: 'å®ç°å…³é”®ä¿¡æ¯æ— æŸä¼ é€’', behaviors: ['ä¿¡æ¯æ— è¡°å‡ä¼ é€’', 'é£é™©å³æ—¶ä¸ŠæŠ¥'] },
            'C3': { name: 'é—®é¢˜é©±åŠ¨', purpose: 'å»ºç«‹ç³»ç»Ÿæ€§è§£å†³é—®é¢˜èƒ½åŠ›', behaviors: ['å¿«é€Ÿå“åº”', 'æ ¹æ²»é—®é¢˜'] },
            'C4': { name: 'è¨€è¡Œä¸€è‡´', purpose: 'æ‰“é€ å¯ä¿¡èµ–çš„ç»„ç»‡æ‰¿è¯º', behaviors: ['æ‰¿è¯ºåŒ¹é…è¿›åº¦', 'è¡¨è¿°ä¸€è‡´'] },
            'C5': { name: 'äº‹å®å¯¼å‘', purpose: 'å®ç°æ•°æ®é©±åŠ¨çš„ç§‘å­¦å†³ç­–', behaviors: ['æ•°æ®å†³ç­–', 'å¯æµ‹é‡ç»“æœ'] },
            'C6': { name: 'ä¿¡æ¯å…±äº«', purpose: 'æœ€å¤§åŒ–çŸ¥è¯†èµ„äº§ä»·å€¼', behaviors: ['çŸ¥è¯†æ²‰æ·€', 'ä¿¡æ¯ä¿é²œ'] },
            'C7': { name: 'çŸ¥è¯†å¤ç”¨', purpose: 'æå‡ç»éªŒè¿ç§»æ•ˆç‡', behaviors: ['ç»éªŒé€‚é…', 'é«˜æ•ˆè½¬åŒ–'] },
            'C8': { name: 'æˆé•¿é€æ˜', purpose: 'åŠ é€Ÿä¸ªäººä¸ç»„ç»‡è¿›åŒ–', behaviors: ['éœ€æ±‚å¯è§', 'äº’åŠ©å“åº”'] },
            'C9': { name: 'å›¢é˜Ÿå…±èµ¢', purpose: 'æ„å»ºååŒå¢æ•ˆçš„ç”Ÿæ€ç³»ç»Ÿ', behaviors: ['ä»·å€¼åˆ›é€ ', 'ä½“éªŒä¼˜åŒ–'] },
            'C10': { name: 'è·¨å›¢é˜Ÿåˆ›æ–°', purpose: 'æ¿€å‘è·¨ç•Œåˆ›æ–°ä»·å€¼', behaviors: ['è¾¹ç•Œçªç ´', 'èµ„æºæ æ†'] },
            'C11': { name: 'ç›®æ ‡éŸ§æ€§', purpose: 'é”»é€ æŠ—å‹é€‚åº”èƒ½åŠ›', behaviors: ['æŠ—å‹æ‰§è¡Œ', 'åŠ¨æ€é€‚åº”'] },
            'C12': { name: 'è¶…é¢„æœŸäº¤ä»˜', purpose: 'åˆ›é€ æŒç»­ä»·å€¼æº¢å‡º', behaviors: ['ä»·å€¼å¢å€¼', 'å³°å€¼ä½“éªŒ'] },
            'C13': { name: 'ç†æ€§æ‹’ç»', purpose: 'èšç„¦æˆ˜ç•¥ä»·å€¼åŒº', behaviors: ['æˆ˜ç•¥å®šåŠ›', 'æä¾›æ›¿ä»£æ–¹æ¡ˆ'] },
            'C14': { name: 'åˆ›æ–°å›æŠ¥', purpose: 'å®ç°é£é™©è°ƒæ•´æ”¶ç›Š', behaviors: ['é£é™©å¯¹å†²', 'å¤±è´¥è½¬åŒ–'] },
            'C15': { name: 'çªç ´æ€§å°è¯•', purpose: 'æ¨åŠ¨å¯æ§è¾¹ç•Œçªç ´', behaviors: ['å¯æ§å†’é™©', 'æé™å­¦ä¹ '] },
            'C16': { name: 'å¤šç»´å°Šé‡', purpose: 'å»ºç«‹æ·±åº¦äº’ä¿¡ç”Ÿæ€', behaviors: ['æ–‡åŒ–å…±è¯†', 'è§’è‰²ä½“éªŒ'] },
            'C17': { name: 'åŒ…å®¹è¿›åŒ–', purpose: 'æ‰“é€ å¤šæ ·æ€§åˆ›æ–°åœŸå£¤', behaviors: ['å¤šå…ƒå†³ç­–', 'å¿ƒç†å®‰å…¨'] },
            'C18': { name: 'è°¦é€Šæˆé•¿', purpose: 'åŠ é€ŸçŸ­æ¿è½¬åŒ–', behaviors: ['ç¼ºå£æŠ«éœ²', 'çŸ¥è¯†è¾å°„'] },
            'C19': { name: 'æ™ºæ…§æ²Ÿé€š', purpose: 'æå‡æ²Ÿé€šè½¬åŒ–æ•ˆç‡', behaviors: ['ä¿¡æ¯å¢å€¼', 'æƒ…ç»ªç”Ÿäº§'] },
            'C20': { name: 'å†²çªä»·å€¼', purpose: 'å°†å†²çªè½¬åŒ–ä¸ºå‡çº§åŠ¨èƒ½', behaviors: ['çŸ›ç›¾è½¬åŒ–', 'æ–‡åŒ–å…ç–«'] }
        };

        const eventTextArea = document.getElementById('eventText');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const resultContent = document.getElementById('resultContent');
        const copyBtn = document.getElementById('copyBtn');

        let originalContent = ''; // å­˜å‚¨åŸå§‹å†…å®¹ç”¨äºå¤åˆ¶

        analyzeBtn.addEventListener('click', analyzeEvent);
        copyBtn.addEventListener('click', copyResult);

        async function analyzeEvent() {
            const eventText = eventTextArea.value.trim();
            
            if (!eventText) {
                showError('è¯·è¾“å…¥äº‹ä»¶æ–‡æœ¬');
                return;
            }

            setLoading(true);
            currentContent = '';
            originalContent = '';
            copyBtn.style.display = 'none';
            resultContent.innerHTML = '<span class="typing-cursor">|</span>';

            try {
                const response = await fetch(API_BASE_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'deepseek-chat',
                        messages: [
                            {
                                role: 'system',
                                content: `ä½ æ˜¯ä¸€ä¸ªä»·å€¼è§‚åŒ¹é…ä¸“å®¶ã€‚æ ¹æ®æä¾›çš„äº‹ä»¶æ–‡æœ¬ï¼Œä»ä»¥ä¸‹20ä¸ªä»·å€¼è§‚å‡†åˆ™ä¸­é€‰æ‹©æœ€åŒ¹é…çš„1-2ä¸ªï¼Œå¹¶ç”Ÿæˆå¯¹åº”çš„è¡Œä¸ºæ¡ˆä¾‹ã€‚

ä»·å€¼è§‚å‡†åˆ™ä¿¡æ¯å’Œå¤§åˆ†ç±»ï¼š

**å¦ç‡çœŸè¯šï¼ˆC1-C5ï¼‰ï¼š**
C1-ç»å¯¹å¦ç‡ï¼šä¸»åŠ¨å‘èµ·äº‰è®®å¯¹è¯ã€é«˜æ•ˆåŒ–è§£åˆ†æ­§
C2-ä¿¡æ¯é€æ˜ï¼šä¿¡æ¯æ— è¡°å‡ä¼ é€’ã€é£é™©å³æ—¶ä¸ŠæŠ¥  
C3-é—®é¢˜é©±åŠ¨ï¼šå¿«é€Ÿå“åº”ã€æ ¹æ²»é—®é¢˜
C4-è¨€è¡Œä¸€è‡´ï¼šæ‰¿è¯ºåŒ¹é…è¿›åº¦ã€è¡¨è¿°ä¸€è‡´
C5-äº‹å®å¯¼å‘ï¼šæ•°æ®å†³ç­–ã€å¯æµ‹é‡ç»“æœ

**å¼€æ”¾åä½œï¼ˆC6-C10ï¼‰ï¼š**
C6-ä¿¡æ¯å…±äº«ï¼šçŸ¥è¯†æ²‰æ·€ã€ä¿¡æ¯ä¿é²œ
C7-çŸ¥è¯†å¤ç”¨ï¼šç»éªŒé€‚é…ã€é«˜æ•ˆè½¬åŒ–
C8-æˆé•¿é€æ˜ï¼šéœ€æ±‚å¯è§ã€äº’åŠ©å“åº”
C9-å›¢é˜Ÿå…±èµ¢ï¼šä»·å€¼åˆ›é€ ã€ä½“éªŒä¼˜åŒ–
C10-è·¨å›¢é˜Ÿåˆ›æ–°ï¼šè¾¹ç•Œçªç ´ã€èµ„æºæ æ†

**æ‰¿è¯ºæ•¢ä¸ºï¼ˆC11-C15ï¼‰ï¼š**
C11-ç›®æ ‡éŸ§æ€§ï¼šæŠ—å‹æ‰§è¡Œã€åŠ¨æ€é€‚åº”
C12-è¶…é¢„æœŸäº¤ä»˜ï¼šä»·å€¼å¢å€¼ã€å³°å€¼ä½“éªŒ
C13-ç†æ€§æ‹’ç»ï¼šæˆ˜ç•¥å®šåŠ›ã€æä¾›æ›¿ä»£æ–¹æ¡ˆ
C14-åˆ›æ–°å›æŠ¥ï¼šé£é™©å¯¹å†²ã€å¤±è´¥è½¬åŒ–
C15-çªç ´æ€§å°è¯•ï¼šå¯æ§å†’é™©ã€æé™å­¦ä¹ 

**å°Šé‡è°¦é€Šï¼ˆC16-C20ï¼‰ï¼š**
C16-å¤šç»´å°Šé‡ï¼šæ–‡åŒ–å…±è¯†ã€è§’è‰²ä½“éªŒ
C17-åŒ…å®¹è¿›åŒ–ï¼šå¤šå…ƒå†³ç­–ã€å¿ƒç†å®‰å…¨
C18-è°¦é€Šæˆé•¿ï¼šç¼ºå£æŠ«éœ²ã€çŸ¥è¯†è¾å°„
C19-æ™ºæ…§æ²Ÿé€šï¼šä¿¡æ¯å¢å€¼ã€æƒ…ç»ªç”Ÿäº§
C20-å†²çªä»·å€¼ï¼šçŸ›ç›¾è½¬åŒ–ã€æ–‡åŒ–å…ç–«

é‡è¦è¦æ±‚ï¼š
1. è¯·åŸºäºäº‹ä»¶æ–‡æœ¬ä¸­çš„å…·ä½“è¡Œä¸ºå’Œç»“æœæ¥åˆ†æï¼Œä¸è¦åŸºäºè¯·æ±‚æˆ–éœ€æ±‚æœ¬èº«
2. è¡Œä¸ºæ¡ˆä¾‹å¿…é¡»è¯¦ç»†æè¿°å…·ä½“å‘ç”Ÿçš„è¡Œä¸ºè¿‡ç¨‹å’Œäº§ç”Ÿçš„ç§¯æå½±å“
3. æ¡ˆä¾‹é•¿åº¦æ§åˆ¶åœ¨50-80å­—ï¼Œè¦ä½“ç°è¡Œä¸ºçš„å®Œæ•´é—­ç¯
4. é‡ç‚¹å…³æ³¨è¢«è®¤å¯äººå‘˜çš„å…·ä½“è¡ŒåŠ¨å’Œè´¡çŒ®
5. è¯­è¨€é£æ ¼è¦æ±‚ï¼šä½¿ç”¨è‡ªç„¶ä½†ä¸å¤±ä¸“ä¸šçš„è¡¨è¿°ï¼Œé¿å…è¿‡äºæ­£å¼çš„å•†ä¸šåŒ–ç”¨è¯
   - ç”¨"å¸®åŠ©"è€Œä¸æ˜¯"ååŠ©"æˆ–"å¸®å¿™"
   - ç”¨"å®Œæˆäº†"è€Œä¸æ˜¯"æå®šäº†"
   - ç”¨"å¿«é€Ÿ"è€Œä¸æ˜¯"è¿…é€Ÿ"
   - ç”¨"ç†æ¸…äº†"è€Œä¸æ˜¯"æ˜ç¡®äº†"
   - å¯ä»¥ä½¿ç”¨"ç„¶å"ã€"æ¥ç€"ç­‰è‡ªç„¶è¿æ¥è¯
   - é¿å…"ç«‹å³"ã€"è¿…é€Ÿ"ã€"é«˜æ•ˆ"ç­‰è¿‡äºæ­£å¼çš„è¯æ±‡

è¡Œä¸ºæ¡ˆä¾‹ç¤ºä¾‹å‚è€ƒï¼š
- å¥½çš„è¡¨è¿°ï¼š"å°ç‹æ¥åˆ°éœ€æ±‚åï¼Œå¿«é€Ÿå¸®åŠ©æˆ‘ä»¬ç†æ¸…äº†æ•´ä¸ªæµç¨‹ï¼Œç„¶åè¿˜åˆ¶ä½œäº†æ–‡æ¡£åˆ†äº«ç»™å›¢é˜Ÿï¼Œå¾ˆæœ‰å¸®åŠ©"
- é¿å…çš„è¡¨è¿°ï¼š"ç‹æŸæ”¶åˆ°éœ€æ±‚åï¼Œè¿…é€ŸååŠ©å›¢é˜Ÿæ˜ç¡®äº†æµç¨‹è§„èŒƒï¼Œå¹¶åˆ¶ä½œäº†è¯¦ç»†æ–‡æ¡£ä¾›å›¢é˜Ÿæˆå‘˜å‚è€ƒ"

è¯·ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ç®€æ´æ ¼å¼è¾“å‡ºï¼š

**å¯¹åº”å‡†åˆ™ç¼–å·**
[å¤§åˆ†ç±»] - C[æ•°å­—] [å‡†åˆ™åç§°]
ï¼ˆå¦‚æœåŒ¹é…å¤šä¸ªå‡†åˆ™ï¼Œå¯ä»¥åˆ—å‡ºå¤šä¸ªï¼Œå¦‚ï¼šå¼€æ”¾åä½œ - C8 æˆé•¿é€æ˜ã€å¼€æ”¾åä½œ - C9 å›¢é˜Ÿå…±èµ¢ï¼‰

**å¯¹åº”è¡Œä¸ºæ¡ˆä¾‹ï¼š**
[è¯¦ç»†æè¿°å…·ä½“å‘ç”Ÿçš„è¡Œä¸ºè¿‡ç¨‹ï¼ŒåŒ…æ‹¬é‡‡å–çš„è¡ŒåŠ¨ã€æ–¹æ³•ã€è¿‡ç¨‹å’Œäº§ç”Ÿçš„ç§¯æç»“æœï¼Œ50-80å­—ï¼Œç”¨ç ”å‘äººå‘˜æ—¥å¸¸å£è¯­åŒ–è¡¨è¿°]`
                            },
                            {
                                role: 'user',
                                content: `è¯·åˆ†æä»¥ä¸‹äº‹ä»¶æ–‡æœ¬ï¼ŒåŒ¹é…æœ€ç¬¦åˆçš„ä»·å€¼è§‚å‡†åˆ™ï¼š\n\n${eventText}`
                            }
                        ],
                        stream: true
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const reader = response.body.getReader();
                const decoder = new TextDecoder();

                resultContent.innerHTML = '';

                while (true) {
                    const { value, done } = await reader.read();
                    if (done) break;

                    const chunk = decoder.decode(value);
                    const lines = chunk.split('\n');

                    for (const line of lines) {
                        if (line.startsWith('data: ')) {
                            const data = line.slice(6);
                            if (data === '[DONE]') continue;
                            
                            try {
                                const parsed = JSON.parse(data);
                                const delta = parsed.choices?.[0]?.delta?.content;
                                if (delta) {
                                    originalContent += delta;
                                    await typeWriter(resultContent, delta);
                                }
                            } catch (e) {
                                console.error('Error parsing SSE data:', e);
                            }
                        }
                    }
                }

                setLoading(false);
                if (originalContent.trim()) {
                    copyBtn.style.display = 'block';
                }

            } catch (error) {
                console.error('Error:', error);
                setLoading(false);
                showError('åˆ†æè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–APIé…ç½®');
            }
        }

        async function copyResult() {
            if (!originalContent.trim()) {
                showError('æ²¡æœ‰å¯å¤åˆ¶çš„å†…å®¹');
                return;
            }

            try {
                // å¤„ç†åŸå§‹å†…å®¹ï¼Œè½¬æ¢ä¸ºçº¯æ–‡æœ¬æ ¼å¼
                let copyText = originalContent
                    // å»é™¤å¤§åˆ†ç±»æ ‡ç­¾ï¼Œåªä¿ç•™å‡†åˆ™ç¼–å·å’Œåç§°
                    .replace(/(å¦ç‡çœŸè¯š|å¼€æ”¾åä½œ|æ‰¿è¯ºæ•¢ä¸º|å°Šé‡è°¦é€Š)\s*-\s*(C\d+\s+[^\n]+)/g, '$2')
                    // å»é™¤markdownæ ¼å¼æ ‡è®°
                    .replace(/\*\*(.*?)\*\*/g, '$1')  // å»é™¤ç²—ä½“æ ‡è®°
                    .replace(/\*(.*?)\*/g, '$1')      // å»é™¤æ–œä½“æ ‡è®°
                    .replace(/`(.*?)`/g, '$1')        // å»é™¤ä»£ç æ ‡è®°
                    .replace(/^#+\s*/gm, '')          // å»é™¤æ ‡é¢˜æ ‡è®°
                    // æ¸…ç†å¤šä½™çš„ç©ºè¡Œ
                    .replace(/\n\s*\n\s*\n/g, '\n\n')
                    .trim();

                await navigator.clipboard.writeText(copyText);
                
                // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸçŠ¶æ€
                const originalText = copyBtn.textContent;
                copyBtn.textContent = 'âœ… å·²å¤åˆ¶';
                copyBtn.classList.add('copied');
                
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                    copyBtn.classList.remove('copied');
                }, 2000);
                
            } catch (err) {
                console.error('å¤åˆ¶å¤±è´¥:', err);
                showError('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å†…å®¹å¤åˆ¶');
            }
        }

        function parseMarkdown(text) {
            let html = text;
            
            // Headers
            html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');
            html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');
            html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');
            
            // Bold text
            html = html.replace(/\*\*(.*?)\*\*/gim, '<strong>$1</strong>');
            
            // Italic text
            html = html.replace(/\*(.*?)\*/gim, '<em>$1</em>');
            
            // Code blocks
            html = html.replace(/`(.*?)`/gim, '<code>$1</code>');
            
            // Line breaks
            html = html.replace(/\n/gim, '<br>');
            
            // Format category tags for value rules (category first)
            html = html.replace(/(å¦ç‡çœŸè¯š|å¼€æ”¾åä½œ|æ‰¿è¯ºæ•¢ä¸º|å°Šé‡è°¦é€Š)\s+-\s+(C\d+\s+[^\n<]+)/gim, 
                '<span class="category-tag $1">$1</span> - $2');
            
            // Wrap case content
            html = html.replace(/(\*\*å¯¹åº”è¡Œä¸ºæ¡ˆä¾‹ï¼š\*\*<br>)(.*?)(?=<br><br>|$)/gims, '$1<div class="case-content">$2</div>');
            
            return html;
        }

        let currentContent = '';
        
        async function typeWriter(element, text) {
            return new Promise((resolve) => {
                let i = 0;
                const speed = 30;
                
                function type() {
                    if (i < text.length) {
                        currentContent += text.charAt(i);
                        element.innerHTML = parseMarkdown(currentContent);
                        i++;
                        setTimeout(type, speed);
                    } else {
                        resolve();
                    }
                }
                type();
            });
        }

        function setLoading(loading) {
            analyzeBtn.disabled = loading;
            loadingSpinner.style.display = loading ? 'block' : 'none';
            
            if (loading) {
                analyzeBtn.textContent = 'åˆ†æä¸­...';
            } else {
                analyzeBtn.textContent = 'åˆ†æä»·å€¼è§‚åŒ¹é…';
            }
        }

        function showError(message) {
            resultContent.innerHTML = `
                <div class="error-message">
                    <strong>é”™è¯¯ï¼š</strong> ${message}
                </div>
            `;
        }

        eventTextArea.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
                analyzeEvent();
            }
        });
    </script>
</body>
</html>